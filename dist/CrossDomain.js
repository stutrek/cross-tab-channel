!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("CrossDomain",[],t):"object"==typeof exports?exports.CrossDomain=t():e.CrossDomain=t()}(this,function(){return function(e){function t(s){if(n[s])return n[s].exports;var o=n[s]={exports:{},id:s,loaded:!1};return e[s].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){o.contentWindow.postMessage(JSON.stringify(e),"*")}var o=null,r=!1,i=[],a={};window.addEventListener("message",function(e){try{var t=JSON.parse(e.data)}catch(e){return}if(t.isCrossTab){var n=t.channel,o=t.message;a[n].listeners.forEach(function(e){return e(o)})}t.isCrossTabStartup&&(r=!0,i.forEach(function(e){"addChannel"===e.method?s({isCrossTabAdd:!0,channel:e.args[0]}):a[e.channel][e.method].apply(a[e.channel],e.args)}),i=null)});var c=function e(t){var c=this;if(n(this,e),this.listen=function(e){c.listeners.indexOf(e)===-1&&c.listeners.push(e)},this.remove=function(e){c.listeners=c.listeners.filter(function(t){return t!==e})},this.emit=function(e){r?s({isCrossTab:!0,channel:c.id,message:e}):i.push({channel:c.id,method:"emit",args:[e]})},!o)throw new Error('To use cross-tab-channel across domains you must first CrossTab.createIframe("http://path/to/cross-tab-channel/iframe.html")');return a[t]?a[t]:(a[t]=this,this.id=t,this.listeners=[],void("undefined"!=typeof window&&(r?s({isCrossTabAdd:!0,channel:t}):i.push({method:"addChannel",args:[t]}))))};c.createIframe=function(e){o=document.createElement("iframe"),o.src=e,o.style.position="absolute",o.style.pointerEvents="none",o.style.zIndex="-1",o.style.height=1,o.style.width=1,o.style.opacity=0,document.body.appendChild(o)},e.exports=c}])});
//# sourceMappingURL=CrossDomain.js.map
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("CrossDomain",[],t):"object"==typeof exports?exports.CrossDomain=t():e.CrossDomain=t()}(this,function(){return function(e){function t(s){if(n[s])return n[s].exports;var o=n[s]={exports:{},id:s,loaded:!1};return e[s].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){o.contentWindow.postMessage(JSON.stringify(e),r)}var o=null,r=null,i=!1,a=[],c={};window.addEventListener("message",function(e){try{var t=JSON.parse(e.data)}catch(e){return}if(t.isCrossTab){var n=t.channel,o=t.message;c[n].listeners.forEach(function(e){return e(o)})}t.isCrossTabStartup&&(i=!0,a.forEach(function(e){"addChannel"===e.method?s({isCrossTabAdd:!0,channel:e.args[0]}):c[e.channel][e.method].apply(c[e.channel],e.args)}),a=null)});var l=function e(t){var r=this;if(n(this,e),this.listen=function(e){r.listeners.indexOf(e)===-1&&r.listeners.push(e)},this.remove=function(e){r.listeners=r.listeners.filter(function(t){return t!==e})},this.emit=function(e){i?s({isCrossTab:!0,channel:r.id,message:e}):a.push({channel:r.id,method:"emit",args:[e]})},!o)throw new Error('To use cross-tab-channel across domains you must first CrossTab.createIframe("http://path/to/cross-tab-channel/iframe.html")');return c[t]?c[t]:(c[t]=this,this.id=t,this.listeners=[],void("undefined"!=typeof window&&(i?s({isCrossTabAdd:!0,channel:t}):a.push({method:"addChannel",args:[t]}))))};l.createIframe=function(e){0===e.indexOf("//")&&(e=window.location.protocol+e),r=/https?:\/\/[^\/]+/.exec(e)[0],o=document.createElement("iframe"),o.src=e,o.style.position="absolute",o.style.pointerEvents="none",o.style.zIndex="-1",o.style.height=1,o.style.width=1,o.style.opacity=0,document.body.appendChild(o)},e.exports=l}])});
//# sourceMappingURL=CrossDomain.js.map